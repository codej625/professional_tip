# 쿠키에 대해 알아보자.

<br />
<br />

* 쿠키란?
---

```
쿠키는 웹사이트가 사용자의 브라우저(클라이언트)에 저장하는 작은 텍스트 파일이다.

이 파일에는 사용자의 방문 기록, 설정, 인증 정보 등 다양한 정보가 담길 수 있다.

웹사이트는 나중에 사용자가 다시 해당 사이트를 방문했을 때,
이 쿠키를 읽어 사용자의 환경을 맞춤 설정하거나,
이전 활동을 기반으로 서비스를 제공하는 데 활용한다.
```

<br />
<br />
<br />
<br />

1. 쿠키의 주요 속성

```
쿠키는 이름-값 쌍으로 이루어져 있으며,
다음과 같은 속성들을 가질 수 있다.

이러한 속성들은 서버가 쿠키를 설정할 때,
HTTP 응답 헤더의 Set-Cookie 지시어를 통해 명시된다.
```

<br />

| 속성 이름        | 설명                                                                                                                                                                                                                                                                                                                         |
| -------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Name           | 쿠키를 식별하는 고유한 이름                                                                                                                                                                                                                                                                                        |
| Value          | 이름에 연결된 값입니다. 실제 저장될 데이터를 담는다.                                                                                                                                                                                                                                                                           |
| Domain         | 이 쿠키가 유효한 도메인을 지정한다. 브라우저는 요청을 보낼 때, 현재 도메인과 쿠키의 도메인이 일치하거나 더 포괄적인 경우에만 쿠키를 함께 전송한다.                                                                                                                                                                                      |
| Path           | 특정 디렉토리 또는 하위 경로 내에서만 쿠키를 유효하게 만든다. 브라우저는 요청 URL의 경로가 쿠키의 경로와 일치하거나 더 구체적인 경우에만 쿠키를 함께 전송한다.                                                                                                                                                                   |
| Expires        | 쿠키가 삭제될 특정 날짜와 시간을 지정한다. 이 날짜가 지나면 쿠키는 자동으로 삭제된다.                                                                                                                                                                                                                                             |
| Max-Age        | 쿠키가 생성된 후부터 유지될 시간(초 단위)을 지정한다. Expires 대신 사용될 수 있으며, 상대적인 시간을 나타낸다.                                                                                                                                                                                                             |
| Secure         | `Secure` 속성이 설정된 쿠키는 HTTPS 연결을 통해서만 전송된다. 보안 연결을 통해서만 쿠키가 전송되도록 하여 중간자 공격으로부터 보호한다.                                                                                                                                                                                 |
| HttpOnly       | `HttpOnly` 속성이 설정된 쿠키는 JavaScript를 통해 접근할 수 없다. 클라이언트 측 스크립트의 접근을 막아 XSS(Cross-Site Scripting) 공격을 방지하는 중요한 보안 설정이다.                                                                                                                                                        |
| SameSite       | 쿠키가 교차 사이트 요청과 함께 전송될지 여부를 제어하여 CSRF(Cross-Site Request Forgery) 공격을 방지하는 데 도움을 준다. `Strict`, `Lax`, `None` 세 가지 값을 가진다. `None` 값을 사용할 때는 `Secure` 속성도 함께 설정해야 한다. 

<br />
<br />
<br />

2. 쿠키의 사용 목적

<br />

`1) 세션 관리` 

```
사용자의 로그인 상태 유지,
장바구니 정보 유지 등 웹 애플리케이션의 상태를 관리한다.
```

`2) 개인화` 

```
사용자 설정, 테마, 언어 등을 저장하여,
사용자에게 맞춤형 경험을 제공한다.
```

`3) 추적`

```
사용자 행동 분석, 광고 타겟팅 등을 위해 사용자의 방문 경로 및 활동을 기록한다.
(최근 개인 정보 보호 규정 강화로 인해 사용에 주의가 필요하다.)
```

`4) 인증`

```
사용자의 신원을 확인하고,
접근 권한을 관리하는 데 사용됩니다.
```

<br />
<br />
<br />

3. 트러블 슈팅

<br />

```
SI 업무중 겪은 예이다.

통합 UI를 담당하는 회사에서,
iframe요청으로 우리회사의 화면을 보여주기로 했던 상황
```

<br />

`1) iframe으로 등록한 주소`

```
SSO 연동이라면,
등록 자체도 SAML 서버로 요청을 해야한다.
```

`2) 도메인(출처)가 다른 문제`

```
도메인 출처가 다르면 일반적으로 쿠키를 읽는게 허용되지 않는다.
```

`3) Cookie 라는 이름을 사용 시`

```
Requset header에 쿠키라는 이름을 사용하면,
브라우저 정책에 따라 막힐 수 있다.
```
